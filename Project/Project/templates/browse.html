{% extends "base.html" %}
{% block content %}
<div id="app" class="container">
	<h2>Browse Listings</h2>
	
	<table class="table table-striped" id="listings_table">
		<thead>
			<tr>
				<th>Photo</th>
				<th>Title</th>
				<th>Description</th>
				<th>Date Posted</th>
			</tr>
		</thead>
		<tr>
			{% for listing in listings %}
				<td><img src="/static/media/{{ listing.photo }}"></td>
				<td>{{ listing.title }}</td>
				<td>{{ listing.description }}</td>
				<td>{{ listing.date_created }}</td>
				<td><a href="/api/listings/{{listing.listing_id}}">View</a></td>
				<td>
					<a href="#" class="edit" title="Edit this entry"><i class="icon-pencil"></i></a>
					<a href="#" class="destroy" title="Delete this entry"><i class="icon-remove"></i></a>
				</td>
		</tr>
			{% endfor %}
		<tfoot>
			<tr>
				<td colspan="5"><button class="btn btn-primary" href="#addListingModal" data-toggle="modal">Add new listing</button></td>
			</tr>
		</tfoot>
	</table>	
</div>

<script type="text/javascript">
	$(function() {
	$("#add_listing").submit(function(e) {
		e.preventDefault();

		dataString = $("#add_listing").serialize();

		$.ajax({
			type : "POST",
			url : "/new_listing/",
			data : dataString,
			success : function(data) {
				$('#addListingModalBody').html(data)
			},
			failure : function(errMsg) {
				$('#addListingModalBody').html("Request failed. Please try again later.");
			},
		});

	});
});
	
</script>

			
	
	
	
	

{% endblock %}



